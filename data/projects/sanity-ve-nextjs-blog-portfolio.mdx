---
title: CMS kullanarak NextJS ile Fullstack Blog/Portfolio Sitesi
summary: Ä°Ã§erik yÃ¶netim sistemleri(CMS) mÃ¼ÅŸterimizin site Ã¼zerinde siz yazÄ±lÄ±mcÄ±nÄ±n yardÄ±mÄ± olmadan iÃ§erik dÃ¼zenlemesi, ekleyip Ã§Ä±karmasÄ± iÃ§in mÃ¼kemmel araÃ§lar olarak karÅŸÄ±mÄ±zÄ±za Ã§Ä±kÄ±yor. Bu projede JAMStack felsefesi ile yaratÄ±lmÄ±ÅŸ bir blog ve indirilebilir iÃ§erik koleksiyonu gÃ¶receksiniz. Ä°ndirilebilir iÃ§eriklere eriÅŸim ise Auth0 yardÄ±mÄ± ile giriÅŸ yapmamÄ±ÅŸ olan kullanÄ±cÄ±lara sÄ±nÄ±rlandÄ±rÄ±lmÄ±ÅŸtÄ±r. Client tarafÄ±nda ise NextJS kullanÄ±lmÄ±ÅŸ ve SEO iÃ§in optimize edilmiÅŸtir.
publishedAt: '2021-10-02'
images:
  [
    '/images/portfolio/sanity-ve-nextjs-blog-portfolio/home.png',
    '/images/portfolio/sanity-ve-nextjs-blog-portfolio/jam.png',
  ]
techStack: ['NextJS', 'Sanity', 'Auth0', 'SASS']
tags: ['nextjs', 'sanity.io', 'auth0', 'jamstack', 'sass/css', 'blog', 'portfolio']
locale: tr
alternate: ''
type: project
isPublished: true
selected: true
github: https://github.com/uguremirmustafa/prepokul-next
demo: https://prepokul.com
---

![prepkul anasayfa](./home.png)

## 1. KullandÄ±ÄŸÄ±m AraÃ§lar/YÃ¶ntemler ve Tercih Nedenlerim

### JAMStack

Wordpress ile alÄ±ÅŸmÄ±ÅŸ olduÄŸumuz all-in-one ya da monolithic sistemlerin tersine JAMStack felsefesi bize kullanacaÄŸÄ±mÄ±z servislerde esneklik ve Ã¼st dÃ¼zey optimizasyon olanaÄŸÄ± sunuyor.

JAMStack(Javascript, API ve Markup) ile Ã§alÄ±ÅŸmanÄ±n verdiÄŸi avantajlarÄ±n baÅŸÄ±nda ise gÃ¼venlik geliyor. Sitenin hareketli parÃ§alarÄ± bir API aracÄ±lÄ±ÄŸÄ±yla geliÅŸtiriciye ulaÅŸtÄ±ÄŸÄ± iÃ§in arka plandaki servislerin nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ± ya da muhtemel gÃ¼venlik sorunlarÄ±nÄ±n neler olduÄŸu ile uÄŸraÅŸmÄ±yor. Bu avantajÄ± projede Auth0 kullanÄ±rken canlÄ± kanlÄ± yaÅŸadÄ±m. BirkaÃ§ satÄ±r kod ile tÃ¼m authentication sÃ¼recini halledebildim.

Projenin scale olmasÄ± durumunda da gayet baÅŸarÄ±lÄ± Ã§alÄ±ÅŸan JAMStack felsefesi, proje CDN'de yaÅŸadÄ±ÄŸÄ± iÃ§in cache gibi karmaÅŸÄ±k ve Ã§etrefilli iÅŸler ile uÄŸraÅŸmadan bizlere gayet yÃ¼ksek bir performans sunuyor. BugÃ¼n 50 blog postunun olduÄŸu sitede yarÄ±n 10000 tane blog olsa dahi aynÄ± performansÄ± elde edeceÄŸini bilmenin rahatlÄ±ÄŸÄ± gerÃ§ekten huzur verici.

### NextJS

Statik web siteleri React ekosisteminde GatsbyJS ile popÃ¼lerlik kazanmÄ±ÅŸtÄ± ancak son bir iki yÄ±lda NextJS geliÅŸtirici deneyimini zirveye Ã§Ä±kartan hamleleri ile gÃ¶nÃ¼llerimizde ayrÄ± bir yere sahip olmayÄ± baÅŸarÄ±yor.

```jsx
export async function getStaticProps(context) {
  const data = await client.fetch(allPostsUnderCategory, { slug: context.params.slug });

  return {
    props: {
      data,
    },
  };
}

export async function getStaticPaths() {
  const slugs = await client.fetch(allPostPaths);

  const paths = await slugs.map((slug) => ({ params: slug }));
  return {
    paths,
    fallback: true,
  };
}
```

_getStaticPaths_ ve _getStaticProps_ fonksiyonlarÄ± ile bÃ¼tÃ¼n blog postlarÄ±nÄ± build-time'da yaratma imkanÄ± sunan NextJS, Ä±ÅŸÄ±k hÄ±zÄ±nda yÃ¼klenen sayfalar ile hem son kullanÄ±cÄ±yÄ± hem de biz geliÅŸtiricileri mutlu ediyor.

![build](./build.png)

### Sanity.io - CMS

Piyasada birÃ§ok CMS bulabilmek mÃ¼mkÃ¼n. Benim Sanity'i tercih etmemdeki en Ã¶nemli faktÃ¶r ise arayÃ¼zde saÄŸa sola tÄ±klamaya gerek kalmadan veri yapÄ±larÄ±nÄ±(schemas) Sanity projesinin iÃ§inde basit bir JS dosyasÄ± ÅŸeklinde oluÅŸturabilmem.

```js
export default {
  name: 'author',
  title: 'Yazar',
  type: 'document',
  fields: [
    {
      name: 'name',
      title: 'Name',
      type: 'string',
    },
    {
      name: 'slug',
      title: 'Slug',
      type: 'slug',
      options: {
        source: 'name',
        maxLength: 96,
      },
    },
    {
      name: 'image',
      title: 'Image',
      type: 'image',
      options: {
        hotspot: true,
      },
    },
    {
      name: 'bio',
      title: 'Bio',
      type: 'array',
      of: [
        {
          title: 'Block',
          type: 'block',
          styles: [{ title: 'Normal', value: 'normal' }],
          lists: [],
        },
      ],
    },
  ],
};
```

Burada gÃ¶rdÃ¼ÄŸÃ¼nÃ¼z author ÅŸemasÄ± bize sorgu yaptÄ±ÄŸÄ±mÄ±zda ÅŸÃ¶yle bir sonuÃ§ veriyor.

```js
  {
    "_id":"7ca4b38e-4fase-45b6-a0d0-7b288273f473"
    "image":{
      "_type":"image"
      "asset":{...}
      "crop":{...}
      "hotspot":{...}
    }
    "name":"Feyza Nur Emirmustafa"
    "slug":{
      "_type":"slug"
      "current":"feyza-nur-emirmustafa"
    }
    "bio":{...}
  }
```

Sorgu yapmak iÃ§in ise kullanÄ±mÄ± gayet kolay ve GraphQL'den bile bazÄ± noktalarda Ã¼stÃ¼n olan _GROQ_ adlÄ± sorgu dilini kullanÄ±yor. Sanity takÄ±mÄ±nÄ±n in-house bir Ã§Ã¶zÃ¼mÃ¼ olan bu sorgu diline ilk baÅŸlarda alÄ±ÅŸmasÄ± zor olsa da mÃ¼kemmel bir slack kanallarÄ± var. ğŸ˜

Ã–rnek bir sorgu gÃ¶stermek gerekirse ğŸ‘‡

```js
*[_type=="author"]{
  name,
  image,
  slug,
  _id,
  bio
}
```

BÃ¼tÃ¼n bunlarÄ±n yanÄ±nda Sanity Studio da mÃ¼ÅŸterinizi tatmin edecek dÃ¼zeyde bir arayÃ¼ze sahip diyebilirim. Her ne kadar bir Contentful kadar havalÄ± durmasa da bu arayÃ¼zÃ¼ dÃ¼zenlemek de bizim elimizde. En nihayetinde Sanity Studio da bir React uygulamasÄ±.`sanity start` komutu ile 3333 portunda ayaÄŸa kalkan studio'yu isterseniz Sanity'nin kendi hostingi Ã¼zerinde Ã¼cretsiz barÄ±ndÄ±rabilir isterseniz de kendiniz host edebilirsiniz.

![sanity studio](./studio.png)

## 2. Projenin Ã–ne Ã‡Ä±kan Ã–zellikleri

### Statik Web Sitesi OlmasÄ±

Bir web sitesinin statik olmasÄ± sanki Ã§ok iÅŸlevsiz gibi algÄ±lanmasÄ±na sebep olabilmekte lakin JAMStack mantÄ±ÄŸÄ± ile bakÄ±ldÄ±ÄŸÄ±nda birÃ§ok iÅŸlevi diÄŸer servislerle halletiÄŸimiz iÃ§in hem istediÄŸimiz fonksiyonlarÄ± siteye dahil etmek hem de statik web sitesinin avantajlarÄ±nÄ± yaÅŸamak mÃ¼mkÃ¼n.

NextJS'in saÄŸladÄ±ÄŸÄ± fonksiyonlar sayesinde hÄ±zlÄ± yÃ¼klenme sÃ¼releri, SEO aÃ§Ä±sÄ±ndan bÃ¼tÃ¼n datanÄ±n build-time'da Ã§ekilmiÅŸ olmasÄ± ve bÃ¶ylece ilk yÃ¼klemede HTML iÃ§inde bu datanÄ±n servis edilmesi gibi avantajlar Ã¶zellikle blog tarzÄ± bir site iÃ§in Ã§ok ciddi avantajlar saÄŸlÄ±yor.

CDN'de cache edilmiÅŸ sayfalar sayesinde server tarafÄ±na Ã§ok daha az yÃ¼k binmesi ve sitenin yÃ¼rÃ¼tme maliyetlerinin Ã§ok dÃ¼ÅŸÃ¼k olmasÄ± da yine statik web sitelerinin haliyle bu sitenin bir diÄŸer avantajÄ±.

### Esnek CMS yapÄ±sÄ±

Sanity.IO benim favori CMS'im. YukarÄ±da da bahsettiÄŸim gibi geliÅŸtiriciye ciddi anlamda bir esneklik saÄŸlÄ±yor. Ä°lerleyen zamanlarda blog sitesinin yanÄ±nda bir e-ticaret platformu entegre etmek de mÃ¼mkÃ¼n. Tek yapmam gereken `product` adÄ±nda bir ÅŸema ile yeni veri yapÄ±larÄ± oluÅŸturmak. Bu ÅŸekilde mÃ¼ÅŸteri hem blogunu hem de e-ticaret verilerini tek yerden idare edebilir.

CMS yapÄ±landÄ±rmasÄ±nÄ±n kod Ã¼zerinden yapÄ±labiliyor olmasÄ± onu benim gÃ¶zÃ¼mde Contentful gibi alternatiflerinin Ã¶nÃ¼ne koyuyor. Benzer tarzda iki tane farklÄ± ÅŸema ile Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±zÄ± dÃ¼ÅŸÃ¼nelim. Bu durumda kod Ã¼zerinden ÅŸemalarÄ± yaratmanÄ±n avantajÄ±nÄ± gÃ¶rebiliriz. Basit bir kopyala yapÄ±ÅŸtÄ±r ile yeni ÅŸemamÄ±z hazÄ±r. AynÄ± ÅŸekilde ÅŸemalarÄ±n dÄ±ÅŸarÄ± aktarÄ±mÄ± ve farklÄ± projelerde kullanÄ±mÄ± da gayet basit.

Sanity zengin plugin kÃ¼tÃ¼phanesi ile de esnekliÄŸini bizlere gÃ¶steriyor. Bunu anlatmak baÅŸka bir yazÄ±nÄ±n konusu olduÄŸu iÃ§in burada kesiyorum. Unutmadan Sanity'nin Ã¼cretsiz sÃ¼rÃ¼mÃ¼ Ã§ok cÃ¶mert olmakla birlikte Ã¼cretli sÃ¼rÃ¼mÃ¼de birÃ§ok rakibine nazaran ucuz. Bu kadar reklamdan sonra devam edelim. ğŸ¤«

### KayÄ±t yapan kullanÄ±cÄ±lara Ã¶zel iÃ§erikleri

Kimlik doÄŸrulama(authentication) ve yetkilendirme(authorization) modern web sitelerinin artÄ±k olmazsa olmazÄ±. Hem kullanÄ±cÄ± verilerini toplayarak bunlardan faydalanmak hem de korunan iÃ§erikleri saklamak iÃ§in olmazsa olmaz. SÄ±fÄ±rdan bir authentication sistemi kurmak hem zaman hem de maliyet aÃ§Ä±sÄ±ndan projenin boyutuna da baÄŸlÄ± olarak yanlÄ±ÅŸ bir tercih olabilir. Ã–zellikle proje baÅŸlangÄ±Ã§ aÅŸamasÄ±nda ise buna yatÄ±rÄ±m yapmaktansa projenin esas Ã¶zelliklerini inÅŸa etmek daha mantÄ±klÄ± olabilir. Bu proje de onlardan biri. Bu sebeple Auth0 free-tier iÅŸimi gayet gÃ¶ren bir Ã§Ã¶zÃ¼m oldu. Auth0 ekibinin NextJS iÃ§in geliÅŸtirmiÅŸ olduÄŸu [SDK](https://github.com/auth0/nextjs-auth0) sayesinde tÃ¼m uygulamaya auth Ã¶zelliÄŸi katmÄ±ÅŸ oldum.

```js
// /pages/api/auth/[...auth0].js

import { handleAuth } from '@auth0/nextjs-auth0';

export default handleAuth();
```

NextJS'in API endpointlerinden faydalanan Auth0 yukarÄ±daki endpoint ile her ÅŸeyi hallediyor.

```jsx
// /pages/_app.js

import { UserProvider } from '@auth0/nextjs-auth0';

function MyApp({ Component, pageProps }) {
  return (
    <UserProvider>
      <Component {...pageProps} />
    </UserProvider>
  );
}

export default MyApp;
```

Burada da uygulamayÄ± sardÄ±ktan sonra `useUser` hook yapÄ±sÄ± ile kullanÄ±cÄ± bilgisine her yerden eriÅŸebiliyoruz. Bu kadar basit.

## 3. KeÅŸkelerim

Bu projedeki en bÃ¼yÃ¼k keÅŸkem CSS tarafÄ±nda oldu ve bu hataya ilk defa dÃ¼ÅŸmÃ¼yorum. ğŸ¥² Projenin tasarÄ±mÄ± iÃ§i gerekli olan tÃ¼m deÄŸiÅŸkenleri(color, padding, shadow vs.) proje baÅŸÄ±nda tanÄ±mlamak yerine sÃ¼rekli kopyala-yapÄ±ÅŸtÄ±r yapmak. Projeyi refactor ederken ilk yapacaÄŸÄ±m ÅŸey _mixin_ yapÄ±sÄ±na ve deÄŸiÅŸkenlere aÄŸÄ±rlÄ±k vermek olacak.

DiÄŸer keÅŸkem ise SVG iconlarÄ±mÄ± saracak(wrap) bir component yaratmalÄ±ydÄ±m. BÃ¶ylece her icona kolaylÄ±kla istediÄŸim proplarÄ± verebilirdim. ğŸ˜®â€ğŸ’¨ Bunu da projeyi refactor ederken dÃ¼ÅŸÃ¼neceÄŸim.

### 3. SonuÃ§

Bu proje sayesinde Sanity'i ve onun sorgu dili olan GROQ'u Ã¶ÄŸrenme ÅŸansÄ± yakalamÄ±ÅŸ oldum. Ã‡ok hÄ±zlÄ± bir ÅŸekilde geliÅŸtirme ve projeyi production'a alma ÅŸansÄ± da tanÄ±yan Sanity mutlaka incelenmeli diye dÃ¼ÅŸÃ¼nÃ¼yorum.

Buna ek olarak geliÅŸtirme sÃ¼reÃ§lerime katkÄ±sÄ± olacak genel bir tecrÃ¼be kazandÄ±ÄŸÄ±mÄ± dÃ¼ÅŸÃ¼nÃ¼yorum. _Ortada sorun yokken kendine sorun yaratma:_ Evet bunu hep yapÄ±yorum ve birÃ§ok arkadaÅŸÄ±n da bu hataya dÃ¼ÅŸtÃ¼ÄŸÃ¼nÃ¼ gÃ¶rÃ¼yorum. Normalde kendi kimlik doÄŸrulama(authentication) ve yetkilendirme(authorization) sistemimi kendim yazardÄ±m. Bunun avantajlarÄ± olmakla beraber bana vakit kaybettirdiÄŸi de bir gerÃ§ekti. O yÃ¼zden bazen hazÄ±r Ã§Ã¶zÃ¼mlerden faydalanmak mantÄ±klÄ± olabiliyor. Auht0 burada imdadÄ±ma yetiÅŸti ve beni birÃ§ok baÅŸ aÄŸrÄ±sÄ±ndan kurtarmakla kalmadÄ±, bana tonla zaman kazandÄ±rdÄ±. ğŸ™ƒ

Belki eklenebilecek baÅŸka noktalar da olabilir ancak bu yazÄ±nÄ±n sÄ±nÄ±rlarÄ±nÄ± zorladÄ±ÄŸÄ±mÄ± hissediyorum.

BaÅŸka projelerde gÃ¶rÃ¼ÅŸmek Ã¼zere. ğŸ‘‹ğŸ‘‹
