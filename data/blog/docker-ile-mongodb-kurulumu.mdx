---
title: Docker ile bilgisayarÄ±nÄ±za MongoDB kurma ve eriÅŸim saÄŸlama
summary: Docker ile bilgisayarÄ±mÄ±za kurmadan birkaÃ§ satÄ±r komut MongoDB'ye eriÅŸebilmek mÃ¼mkÃ¼n. Gelin nasÄ±l yapÄ±lacaÄŸÄ±nÄ± birlikte keÅŸfedelim.
publishedAt: '2021-09-20'
image: '/images/blog/docker-ile-mongodb-kurulumu/banner.png'
locale: tr
tags: ['docker', 'mongodb', 'veritabanÄ±', 'veritabanÄ± baÄŸlantÄ±sÄ±']
isPublished: true
alternate: ''
type: blog
selected: true
---

![mongodb and docker](./banner.png)

MongoDB _NoSQL veritabanlarÄ±_ arasÄ±nda en yaygÄ±n olarak kullanÄ±lan veritabanÄ±. Ã–zellikle JavaScript ve NodeJS Ã§evresinde sÄ±klÄ±kla tercih edilen MongoDB'yi bilgisayarÄ±mÄ±za indirmeden Docker ile kullanmak mÃ¼mkÃ¼n. Gelin hem Ã§ok pratik hem de zaman kazandÄ±ran bu yÃ¶ntemi birlikte inceleyelim.

Bu yazÄ±mÄ±zda:

- Docker nedir ve ne iÅŸe yarar?
- Docker ile MongoDB container nasÄ±l yaratÄ±lÄ±r?
  - MongoDB image dosyasÄ±nÄ± arama
  - docker-compose.yml dosyasÄ± oluÅŸturma
- VeritabanÄ±na nasÄ±l baÄŸlanabiliriz?
  - Terminalden baÄŸlanma
  - Node.js uygulamasÄ±ndan baÄŸlanma

sorularÄ±na cevap arayacaÄŸÄ±z. Hadi baÅŸlayalÄ±m...

> Devam etmeden Ã¶nce bilgisayarÄ±nÄ±zda Docker'Ä±n ve docker-compose'un yÃ¼klÃ¼ ve Ã§alÄ±ÅŸÄ±r olduÄŸundan emin olun!

## 1. Docker Nedir ve Ne Ä°ÅŸimize Yarayacak?

Docker containerlar kullanarak kolayca uygulamalar yaratÄ±p Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±z ve deploy ettiÄŸimiz bir araÃ§ olarak karÅŸÄ±mÄ±za Ã§Ä±kÄ±yor. Container yapÄ±sÄ±nÄ±, uygulamanÄ±n baÄŸÄ±mlÄ±lÄ±klarÄ±nÄ±n ve kendi kaynak kodunun bir paket haline getirilmesi ve izole bir ÅŸekilde Ã§alÄ±ÅŸmasÄ± ÅŸeklinde dÃ¼ÅŸÃ¼nebiliriz.

Docker aynÄ± ÅŸekilde bir MongoDB Ã¶rneÄŸini Ã§alÄ±ÅŸtÄ±rmak iÃ§in de kullanÄ±labilir ki biz bugÃ¼n bunu yapacaÄŸÄ±z. Bunu yaparken birkaÃ§ satÄ±r kod ile MongoDB'yi bilgisayarÄ±mÄ±za kurmaktan ve bir ton ayarlama yapmaktan kurtulacaÄŸÄ±z. AyrÄ±ca bire bir aynÄ± Ã¶rneÄŸi _docker-compose.yml_ dosyasÄ± sayesinde kolayca farklÄ± ortamlara taÅŸÄ±yabileceÄŸiz.

## 2. Docker MongoDB Container Yaratma

Ä°lk olarak Docker'da MongoDB image dosyasÄ±nÄ± arayalÄ±m. AynÄ± iÅŸlemi [Docker Hub](https://hub.docker.com/search?type=image) aracÄ±lÄ±ÄŸÄ±yla da yapabilirsiniz.

```bash
docker search mongodb
```

Bu arama bize resmi(official) ve topluluÄŸun yaratmÄ±ÅŸ olduÄŸu image dosyalarÄ±nÄ± sonucunu verdi. _mongo_ isimli image bizim ihtiyacÄ±mÄ±z olan resmi MongoDB uygulamasÄ±nÄ±n Docker versiyonu.

Gerekli image dosyasÄ±nÄ± bulduÄŸumuza gÃ¶re artÄ±k _docker-compose_ ile Ã§alÄ±ÅŸmaya baÅŸlayabiliriz.

VarsayÄ±lan olarak, MongoDB containerlarÄ± veritabanÄ±nÄ± container iÃ§inde `/data/db` isimli bir klasÃ¶rde tutmaktalar. Bizim ihtiyacÄ±mÄ±z olan ise docker-compose dosyasÄ±nÄ± ve veritabanÄ± verilerini saklayacaÄŸÄ±mÄ±z local bir klasÃ¶r oluÅŸturmak. Bu klasÃ¶rÃ¼ bilgisayarÄ±nÄ±zda istediÄŸiniz bir noktada oluÅŸturabilirsiniz. AÅŸaÄŸÄ±daki kod bize iÃ§ iÃ§e geÃ§miÅŸ bir klasÃ¶r yapÄ±sÄ± ve docker-compose.yml dosyasÄ± yaratacak.

```bash
mkdir -pv mongodb/database
cd mongodb
touch docker-compose.yml
```

KlasÃ¶r yapÄ±sÄ± ÅŸu ÅŸekilde olacak: ğŸ‘‡

![folder structure](./tree.png)

Åimdi docker-compose.yml dosyasÄ± Ã¼zerinde Ã§alÄ±ÅŸabiliriz. Ã–nce dosyanÄ±n son haline bakalÄ±m, ardÄ±ndan satÄ±r satÄ±r inceleyelim.

```yml
version: '3.8'
services:
  mongodb:
    image: mongo
    container_name: mongodb
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - /home/anomy/Development/mongodb/database:/data/db
    ports:
      - 27017:27017
    restart: unless-stopped
```

<ProTip tip=".yml uzantÄ±lÄ± dosyalarda satÄ±r girinti ve Ã§Ä±kÄ±ntÄ±larÄ± Ã§ok Ã¶nemlidir. Bu yÃ¼zden kodu kopyalÄ±yorsan dikkatli ol!" />

### docker-compose.yml

Version bilgisi Docker'Ä±n nasÄ±l Ã§alÄ±ÅŸmasÄ± gerektiÄŸini belirleyen bir bilgi. Ã‡eÅŸitli sÃ¼rÃ¼mlerde .yml dosyasÄ± farklÄ± yorumlanabiliyor.

services bloÄŸunda tek servisimiz olan mongodb var. Burada verdiÄŸimiz isim Ã§ok Ã¶nemli deÄŸil. Bir alt satÄ±rda ilgili _image_ dosyasÄ±nÄ±n adÄ±nÄ± veriyoruz. HatÄ±rlarsanÄ±z yukarÄ±da yaptÄ±ÄŸÄ±mÄ±z search ile bu image ismine ulaÅŸmÄ±ÅŸtÄ±k.

container_name, `docker ps` ile Ã§alÄ±ÅŸan containerlarÄ± listelediÄŸimizde bizim MongoDB container'Ä±mÄ±zÄ±n yanÄ±nda yazacak olan isme denk geliyor. Container'a ulaÅŸÄ±rken iÅŸimize yarayacak.

Ã–nemli bir diÄŸer kÄ±sÄ±m olan volumes bloÄŸunda ise _volume mappÄ±ng_ yapÄ±yoruz. Container iÃ§indeki verileri bilgisayarÄ±mÄ±zÄ±n localinde nerede tutacaÄŸÄ±mÄ±zÄ± belirtiyoruz. (:) iki noktadan Ã¶nceki kÄ±sÄ±m bilgisayarÄ±mÄ±zdaki klasÃ¶r yapÄ±sÄ±nÄ±n yolunu iÅŸaret ederken ikinci kÄ±sÄ±m containerÄ±n iÃ§indeki yola denk geliyor. ports kÄ±smÄ±da aynÄ± mantÄ±kla Ã§alÄ±ÅŸÄ±yor. Ä°Ã§erdeki 27017 portunu localimizdeki 27017'ye baÄŸlÄ±yoruz.

restart satÄ±rÄ± ise kullanÄ±cÄ± tarafÄ±ndan durdurulmadÄ±ÄŸÄ± sÃ¼rece bilgisayarÄ± her baÅŸlattÄ±ÄŸÄ±mÄ±zda containerÄ±n baÅŸlamasÄ± gerektiÄŸini sÃ¶ylÃ¼yor.

### Container'Ä± ayaÄŸa kaldÄ±rma

ArtÄ±k docker-compose.yml dosyamÄ±z hazÄ±r olduÄŸuna gÃ¶re bu dosyada belirlemiÅŸ olduÄŸumuz ayarlar ile container'Ä±mÄ±zÄ± ayaÄŸa kaldÄ±rabiliriz. DosyanÄ±n bulunduÄŸu konumda aÅŸaÄŸÄ±daki kodu Ã§alÄ±ÅŸtÄ±rarak container@i (-d) detached modda baÅŸlatabiliriz.

```bash
docker-compose up -d
```

<ProTip tip="Detached mod loglarÄ± gizleyerek terminalimizi boÅŸ bÄ±rakÄ±r." />

Container'Ä±n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± containerlarÄ± listeleyerek Ã¶ÄŸrenebiliriz. ğŸ‘‡ Ä°sim kÄ±smÄ±na dikkat ederseniz container_name iÃ§in girmiÅŸ olduÄŸumuz deÄŸerle aynÄ± olduÄŸunu gÃ¶rebilirsiniz.

```bash
docker ps
```

![list running docker containers](./list.png)

## 3. VeritabanÄ±na EriÅŸim

Åimdi ise yarattÄ±ÄŸÄ±mÄ±z veritabanÄ±na baÄŸlanmaya Ã§alÄ±ÅŸalÄ±m. Bazen terminal aracÄ±lÄ±ÄŸÄ±yla bazen de uygulama iÃ§inden veritabanÄ±na baÄŸlanmak ve veritabanÄ± Ã¼zerinde Ã§eÅŸitli iÅŸlemler yapmamÄ±zÄ± gerektirecek durumlarla karÅŸÄ±laÅŸabiliriz. Gelin ÅŸimdi bu yÃ¶ntemleri keÅŸfedelim.

### a. Terminalden eriÅŸim

Container'a interaktif terminal ile ulaÅŸÄ±p veritabanÄ±nda Ã§eÅŸitli iÅŸlemler yapabiliriz. (-it) flag'i ile interaktif terminali baÅŸlatabiliriz.

```bash
docker exec -it mongodb bash
```

Åu anda container'Ä±n iÃ§erisindeyiz. Burada `mongo` komutu ile MongoDB'ye baÄŸlanabilir ve istediÄŸimiz mongo sorgularÄ±nÄ± Ã§alÄ±ÅŸtÄ±rabiliriz.

```bash
mongo
```

```bash
show dbs
use mydatabase
db.user.insert({name: "ugur emirmustafa", age: 25})
show dbs
db.user.find()
```

### b. Node.js uygulamasÄ±ndan eriÅŸim

Node.js uygulamasÄ±ndan MongoDB'ye eriÅŸim iÃ§in Ã§eÅŸitli yÃ¶ntemler olsa da en popÃ¼ler olan yÃ¶ntem `mongoose` aracÄ±nÄ± kullanarak baÄŸlanmak. Gelin projeyi oluÅŸturalÄ±m.

```bash
mkdir mongo-node-uygulamam
cd mongo-node-uygulamam
yarn init -y
yarn add -D nodemon
yarn add express mongoose
touch index.js
```

index.js dosyasÄ±nda projeyi oluÅŸturalÄ±m.

Ä°lk olarak gerekli paketleri projeye dahil edelim.

```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();

app.use(express.json());
```

ArdÄ±ndan mongoose aracÄ±lÄ±ÄŸÄ±yla mongodb'ye baÄŸlantÄ±yÄ± kuralÄ±m.

```js
mongoose.connect('mongodb://localhost:27017/mongo', {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});
```

Buradaki url yapÄ±sÄ±ndaki kÄ±sÄ±mlara dikkat edelim. `localhost:27017` bilgisayarÄ±mÄ±zÄ±n kendi localindeki 27017 portunu temsil ediyor. `docker-compose.yml` dosyasÄ±nda expose ettiÄŸimiz portun 27017 olduÄŸunu hatÄ±rlayÄ±n. / iÅŸaretinden sonraki kÄ±sÄ±m veritabanÄ±nÄ±n adÄ±nÄ± ifade ediyor. Herhangi bir isim verebilirsiniz. Biz _mongo_ adÄ±nÄ± verdik.

Ä°kinci parametredeki seÃ§enekler standart ayarlar olarak karÅŸÄ±mÄ±za Ã§Ä±kÄ±yor.

```js
const db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB baÄŸlantÄ± hatasÄ±!: '));
db.once('open', function () {
  console.log('VeritabanÄ± baÅŸarÄ±yla baÄŸlandÄ±');
});
```

Burada ise baÄŸlantÄ± kurulup kurulmamsÄ±na gÃ¶re console'a farklÄ± mesajlar bastÄ±rÄ±yoruz. ArdÄ±ndan 4000 portunda server'Ä± Ã§alÄ±ÅŸtÄ±rÄ±yoruz.

```js
app.listen(4000, () => {
  console.log(`Server http://localhost:4000 adresinde Ã§alÄ±ÅŸÄ±yor...`);
});
```

package.json dosyasÄ±na kÃ¼Ã§Ã¼k bir `dev` script'i ekleyelim ki `yarn dev` komutu ile kolayca server'Ä± baÅŸlatabilelim.

```json
 "scripts": {
    "dev": "nodemon server.js"
  }
```

<ProTip tip="nodemon, dosya deÄŸiÅŸikliklerini izleyen ve server'Ä± her seferinde yeniden baÅŸlatan kullanÄ±ÅŸlÄ± bir araÃ§tÄ±r." />

`yarn dev` komutu sonrasÄ±nda console'da ÅŸu mesajlarÄ± gÃ¶rebiliyorsak iÅŸlem baÅŸarÄ±lÄ± demektir. ğŸ‘‡

```bash
[nodemon] starting `node server.js`
Server http://localhost:4000 adresinde Ã§alÄ±ÅŸÄ±yor...
VeritabanÄ± baÅŸarÄ±yla baÄŸlandÄ±
```

## SonuÃ§

Docker bizlere izole Ã§alÄ±ÅŸma ortamlarÄ± oluÅŸturma ve bu ortamlarÄ± taÅŸÄ±ma noktasÄ±nda ciddi kolaylÄ±klar saÄŸlÄ±yor. Burada yapmÄ±ÅŸ olduÄŸumuz Ã§alÄ±ÅŸma her ne kadar basit olsa da umarÄ±m sizleri docker konusunda daha detaylÄ± Ã§alÄ±ÅŸmalara hazÄ±rlama adÄ±na yararlÄ± olmuÅŸtur.

ArtÄ±k Docker ile MongoDB'ye baÄŸlanmak daha kolay. ğŸ˜„

Yeni yazÄ±lardan haberdar olmak ve iÃ§erik talepleriniz iÃ§in bana [twitter](https://twitter.com/uguremirmustafa) Ã¼zerinden ulaÅŸabilir ve beni takip edebilirsiniz.

Ä°yi Ã§alÄ±ÅŸmalar! ğŸ§‘â€ğŸ’»ğŸ’»ğŸ¥³
